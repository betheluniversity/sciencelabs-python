{% extends 'session/base.html' %}

{% block header %}
    <div class="header card">
        <div class="card-body">
            {# TODO MAKE SURE TO UPDATE WHEN CONNECTING TO DATABASES #}
            <p class="card-text">Past Sessions for ***SEMESTER YEAR***</p>
        </div>
    </div>
{% endblock %}

{% block semester_switch %}
    <form class="form-inline">
        <button type="button" class="btn btn-primary">Set</button>
        <select class="custom-select">
            {% for semester in app_settings['SEMESTER_OPTIONS'] %}
                <option value="{{ semester }}">{{ semester }}</option>
            {% endfor %}
        </select>
    </form>
{% endblock %}

{% block body_content %}
    <table id="closed-table"  class="table table-striped table-bordered" style="width:100%">
        <thead>
            <tr>
                <th>Name</th>
                <th>Date</th>
                <th>Time</th>
                <th>Room</th>
                <th>Tutors</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for session in sessions %}
                <tr>
                    <td>
                        {{ session.name + ' (' + session.date.strftime('%m/%d/%Y') + ')'  }}
                    </td>
                    <td>
                        {{ session.date.strftime('%m/%d/%Y') }}
                    </td>
                    <td>
                        {{ session.startTime|datetimeformat + ' - ' + session.endTime|datetimeformat }}
                    </td>
                    <td>
                        {{ session.room }}
                    </td>
                    <td>
                        <button type="button" class="show-tutors btn btn-primary">Show</button>
                        <div style="display:none;margin-top:10px" class="text-left">
                        {% set leads, tutors = session_tutors.get_session_tutors(session.id) %}
                        {% for lead in leads %}
                            {{ lead.firstName }} {{ lead.lastName }} <span class="button-labels">Lead</span><br />
                        {% endfor %}
                        {% for tutor in tutors %}
                            {{ tutor.firstName }} {{ tutor.lastName }}<br />
                        {% endfor %}
                        </div>
                    </td>
                    <td>
                        <div class="btn-group">
                            <a href='{{ url_for('SessionView:edit_session', session_id=session.id) }}' class="edit btn btn-primary">Edit</a>
                            <a href='{{ url_for('SessionView:delete_session', session_id=session.id) }}' class="delete btn btn-primary">Delete</a>
                        </div>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
         $(document).ready( function () {
            $.extend($.fn.dataTableExt.oStdClasses, {
                // give some foundation classes to our controls
                sWrapper: 'large-12 columns ',
                sLength: 'large-4 columns ',
                sFilter: 'large-12 columns ',
                sInfo: 'large-4 left ',
                sPaging: 'right ',
                sPageButton: 'button small',
                sPageButtonDisabled: 'disabled',
                sPageButtonActive: 'success'
            });
            var closedSessionTable = $('#closed-table').dataTable({
               "order": [[1, 'asc'],[2, 'asc']],
                 "bPaginate": false,
                "oLanguage": {
                    "sSearch": "Search:"
                }
             });
             $(".show-tutors").click(function() {
                 $(this).next().toggle();
                 if($(this).text() !== 'Show')
                     $(this).text('Show');
                 else
                     $(this).text('Hide');
             });
         });
           
    </script>

{% endblock %}