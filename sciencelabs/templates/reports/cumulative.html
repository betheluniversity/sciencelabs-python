{% extends 'reports/base.html' %}

    {% block header %}
        <div class="header card">
            <div class="card-body btn-group">
                <p class="col-sm-12" style="padding: 0px; margin: 0px">Attendance for {{ app_settings['LAB_TITLE'] }}</p>
                <a href="" class="csv-button btn btn-primary">CSV Export</a>
            </div>
            <div class="card-body">
                <p style="padding: 0px; margin: 0px;"><strong>Fall 2014 - Present:</strong> Records in this current
                    attendance application include professor, course, student, and tutor information. </p>
                <p style="padding: 0px; margin: 0px;"><strong>Spring 2004 - Spring 2014 *:</strong> Records for this
                    time period were imported from an old web based attendance application and do not include professor
                    or tutor information. These session are titled, “Old {{ app_settings['LAB_TITLE'] }}”.</p>
                <p style="padding: 0px; margin: 0px;"><strong>Fall 1992 - Fall 2003:</strong> Records from this time
                    period were transcribed from paper sign ins and only include monthly attendance totals.</p>
            </div>
        </div>
    {% endblock %}

{% block semester_switch %}{% endblock %}

{% block body_content %}
            {# TODO FILL TABLE #}
            <table id="table"  class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>Year</th>
                        <th>Aug</th>
                        <th>Sep</th>
                        <th>Oct</th>
                        <th>Nov</th>
                        <th>Dec</th>
                        <th>Fall</th>
                        <th>Jan</th>
                        <th>Feb</th>
                        <th>Mar</th>
                        <th>Apr</th>
                        <th>May</th>
                        <th>Spring</th>
                        <th>Jun</th>
                        <th>Jul</th>
                        <th>Summer</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                {% for info in cumulative %}
                        <tr>
                            <td>{{ cumulative[info]['academicYear'] }}</td>
                            <td>{{ cumulative[info]['monthly'][8] }}</td>
                            <td>{{ cumulative[info]['monthly'][9] }}</td>
                            <td>{{ cumulative[info]['monthly'][10] }}</td>
                            <td>{{ cumulative[info]['monthly'][11] }}</td>
                            <td>{{ cumulative[info]['monthly'][12] }}</td>
                            <td class="side-borders">{{ cumulative[info]['fallTotal'] }}</td>
                            <td style="border-right: 2px solid #000000">{{ cumulative[info]['monthly'][1] }}</td>
                            <td>{{ cumulative[info]['monthly'][2] }}</td>
                            <td>{{ cumulative[info]['monthly'][3] }}</td>
                            <td>{{ cumulative[info]['monthly'][4] }}</td>
                            <td>{{ cumulative[info]['monthly'][5] }}</td>
                            <td class="side-borders">{{ cumulative[info]['springTotal'] }}</td>
                            <td>{{ cumulative[info]['monthly'][6] }}</td>
                            <td>{{ cumulative[info]['monthly'][7] }}</td>
                            <td class="side-borders">{{ cumulative[info]['summerTotal'] }}</td>
                            <td style="border-right: 2px solid #000000;">{{ cumulative[info]['yearTotal'] }}</td>
                        </tr>
                {% endfor %}
                {% for semester in semesters %}
                    <tr>
                        <td>{{ semester.year }}-{{ semester.year + 1 }}</td>
                        {% set fall_total = [0] %}
                        {% for i in range(8, 13) %}
                            {% set temp = (session_.get_monthly_sessions_attendance((semester.year|string + '-' + i|string + '-1'), (semester.year|string + '-' + i|string + '-31'))|length) %}
                            <td>{{ temp }}</td>
                            {% if fall_total.append(fall_total.pop() + temp) %}{% endif %}
                        {% endfor %}
                    <td class="side-borders">{{ fall_total[0] }}</td>
                    <td style="border-right: 2px solid #000000">{{ session_.get_monthly_sessions_attendance(((semester.year + 1)|string + '-01-1'), ((semester.year + 1)|string + '-01-31'))|length }}</td>
                    {% set spring_total = [0] %}
                    {% for i in range(2, 6) %}
                        {% set temp = (session_.get_monthly_sessions_attendance(((semester.year + 1)|string + '-' + i|string + '-1'), ((semester.year + 1)|string + '-' + i|string + '-31'))|length) %}
                        <td>{{ temp }}</td>
                        {% if spring_total.append(spring_total.pop() + temp) %}{% endif %}
                    {% endfor %}
                    <td class="side-borders">{{ spring_total[0] }}</td>
                    {% set summer_total = [0] %}
                    {% for i in range(6, 8) %}
                        {% set temp = (session_.get_monthly_sessions_attendance(((semester.year + 1)|string + '-' + i|string + '-1'), ((semester.year + 1)|string + '-' + i|string + '-31'))|length) %}
                        <td>{{ temp }}</td>
                        {% if summer_total.append(summer_total.pop() + temp) %}{% endif %}
                    {% endfor %}
                    <td class="side-borders">{{ summer_total[0] }}</td>
                    <td style="border-right: 2px solid #000000">{{ fall_total[0] + spring_total[0] + summer_total[0] + (session_.get_monthly_sessions_attendance(((semester.year + 1)|string + '-01-1'), ((semester.year + 1)|string + '-01-31'))|length) }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
    <script>
        $(document).ready( function () {
            var table = $('#table').DataTable({
                columnDefs: [
                    { orderable: false, targets: '_all' }
                    ],
                "aaSortingFixed": [0, 'desc'],
                "bPaginate": false,
                "bLengthChange": false,
                "bFilter": false,
                "bInfo": false
            });
        });
    </script>
{% endblock %}