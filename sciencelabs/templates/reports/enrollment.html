{% extends 'reports/base.html' %}

{% block header %}
    <div class="header card">
        <div class="card-body btn-group">
            <p class="no-margin-padding">{{ lab_title }} Enrollment Report</p>
            <a href="{{ url_for('ReportView:export_enrollment_csv') }}" class="csv-button btn btn-primary">CSV Export</a>
        </div>
    </div>
{% endblock %}

{% block semester_switch %}{% endblock %}

{% block body_content %}
    <div class="custom-default row">
        <div class="col-md-8">
            <table id="new-table"  class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th data-toggle="tooltip" data-placement="top" title="Semester Term and Year">Semester</th>
                        <th data-toggle="tooltip" data-placement="top" title="Total Attendance for Semester">Total</th>
                        <th data-toggle="tooltip" data-placement="top" title="Total Unique Attendance for Semester">Unique</th>
                        <th data-toggle="tooltip" data-placement="top" title="Total Enrolled for Lab Courses">Enrolled</th>
                        <th data-toggle="tooltip" data-placement="top" title="% of Enrolled">Percent</th>
                    </tr>
                </thead>
                <tbody>
                    {% for semester, attendance_info in semesters_and_attendance.items() %}
                        <tr>
                            <td class="year-range">{{ semester.term }} {{ semester.year }}</td>
                            <td>{{ attendance_info['totalAttendance'] }}</td>
                            <td>{{ attendance_info['uniqueAttendance'] }}</td>
                            <td>{{ attendance_info['enrolled'] }}</td>
                            <td>
                                {% if attendance_info['enrolled'] > 0 %}
                                    {{ (attendance_info['uniqueAttendance'] / attendance_info['enrolled'] * 100)|round(1) }}%
                                {% else %}
                                    0.0%
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="col-md-4">
            <div class="sub-info card info">
                <div class="card-body">
                    <p class="card-text">
                        This page contains stats for {{ lab_title }} course enrollment by semester.
                    </p>
                    <p class="card-text">
                        <strong>Total</strong> is the total attendance for all sessions held that semester. This
                        includes students who attended the same session twice.
                    </p>
                    <p class="card-text">
                        <strong>Unique</strong> is the total number of unique students who visited {{ lab_title }} that
                        semester.
                    </p>
                    <p class="card-text">
                        <strong>Enrolled</strong> is the total number of students enrolled in courses that
                        {{ lab_title }} held sessions for that semester. We did not track this data before Spring 2015,
                        so for those semesters this column will be 0. This will also cause the Percent column to be 0.
                    </p>
                    <p class="card-text">
                        <strong>Percent</strong> is calculated by (unique/enrolled)&times;100. It is the percent of students
                        enrolled in {{ lab_title }} courses that went to at least one session. Please note that this
                        does not account for students who were in more than one course serviced by {{ lab_title }}, so
                        this is only an approximation.
                    </p>
                </div>
            </div>
        </div>
    </div>
{% endblock %}