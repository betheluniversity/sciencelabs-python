{% extends 'sessions/base.html' %}

{% block body_content %}
    <h5>Select the session you wish to sub for:</h5>
    <table id="sessions-table"  class="table table-striped table-bordered">
        <thead>
            <tr>
                <th data-toggle="tooltip" data-placement="top" title="Session Name">Name</th>
                <th data-toggle="tooltip" data-placement="top" title="Session Date">Date</th>
                <th data-toggle="tooltip" data-placement="top" title="Session Time">Time</th>
                <th data-toggle="tooltip" data-placement="top" title="Session Room">Room</th>
                <th data-toggle="tooltip" data-placement="top" title="Session Capacity">Session Capacity</th>
                <th data-toggle="tooltip" data-placement="top" title="Session Zoom Url">Zoom Url</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for session in sessions %}
                <tr>
                    <td data-th="Session Name">
                        {{ session.name }}
                    </td>
                    <td data-th="Session Date">
                        {{ session.date.strftime('%m/%d/%Y') }}
                    </td>
                    <td data-th="Session Time">
                        {{ session.schedStartTime|datetimeformat + ' - ' + session.schedEndTime|datetimeformat }}
                    </td>
                    <td data-th="Session Room">
                        {{ session.room }}
                    </td>
                    <td data-th="Session Capacity">
                        {{ session.capacity }}
                    </td>
                    <td data-th="Session Zoom Url">
                        <a href="{% if session.zoom_url %}{{ session.zoom_url }}{% endif %}">{% if session.zoom_url %}{{ session.zoom_url }}{% endif %}</a>
                    </td>
                    <td class="text-center">
                        <button type="button" id="{{ session.id }}" class="blue btn btn-primary select-session">Sub for this Session</button>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <script type="text/javascript">
        $(document).ready(function () {
            $('.select-session').click(function () {
                $.ajax({
                    type: "POST",
                    url: "{{ url_for('SessionView:select_sub_session') }}",
                    data: JSON.stringify({
                        'session_id': this.id,
                        'tutor_id': {{ tutor_id }},
                    }),
                    contentType: 'application/json;charset=UTF-8',
                    success: function (response) {
                        window.location.replace("{{ url_for('SessionView:tutor_room_group_attendance_passthrough', room_group_id=room_group_id) }}");
                    },
                    error: function (error) {
                    }
                });
            });
        })
    </script>
{% endblock %}