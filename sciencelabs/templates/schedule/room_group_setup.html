{% extends 'schedule/base.html' %}

{% block body_content %}
    <div class="custom-default row">
        <div class="col-md-8">
            <form role="form" action="{{ url_for('ScheduleView:save_room_groups') }}" method="POST">
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <div class="header card">
                            <div class="card-body btn-group">
                                <p class="no-margin-padding">Set up Room Groupings for Schedules for {{ active_semester.term }} {{ active_semester.year }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <table id="table" class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th>DOW #</th>
                            <th data-toggle="tooltip" data-placement="top" title="Schedule Name">Name</th>
                            <th data-toggle="tooltip" data-placement="top" title="Day of Week">DOW</th>
                            <th data-toggle="tooltip" data-placement="top" title="Schedule Time">Time</th>
                            <th data-toggle="tooltip" data-placement="top" title="Schedule Room">Room</th>
                            <th data-toggle="tooltip" data-placement="top" title="Schedule Courses">Courses</th>
                            <th data-toggle="tooltip" data-placement="top" title="Schedule Tutors">Tutors</th>
                            <th data-toggle="tooltip" data-placement="top" title="Room Group">Add to Room Group</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for schedule, tutors_and_courses in schedule_tutors_and_courses.items() %}
                            <tr>
                                <td>
                                    {{ schedule.dayofWeek }}
                                </td>
                                <td>
                                    {{ schedule.name }}
                                </td>
                                <td>
                                    {{ macros.day_abbr(schedule.dayofWeek) }}
                                </td>
                                <td>
                                    {{ schedule.startTime|datetimeformat + ' - ' + schedule.endTime|datetimeformat }}
                                </td>
                                <td>
                                    {{ schedule.room }}
                                </td>
                                <td>
                                    <button id="show-courses" type="button" class="show-courses blue btn btn-primary">Show</button>
                                    <div class="course-td text-left margin-top-10">
                                        <ul>
                                            {% for course in tutors_and_courses['courses'] %}
                                                <li>
                                                    {{ course }}
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </td>
                                <td>
                                    <button id="show-tutors" type="button" class="show-tutors blue btn btn-primary">Show</button>
                                    <div class="tutor-td text-left margin-top-10">
                                        {% for tutor in tutors_and_courses['tutors'] %}
                                        {% if tutor.isLead %}
                                            {{ tutor.firstName }} {{ tutor.lastName }}<br><span class="button-labels">Lead</span><br>
                                        {% else %}
                                            {{ tutor.firstName }} {{ tutor.lastName }}<br>
                                        {% endif %}
                                            {% endfor %}
                                    </div>
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="{{ schedule.id }}" {% if room_group_check[schedule.id] %}checked{% endif %}>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <button type="submit" class="btn blue btn-primary margin-top-10" id="save-room-groupings">Save</button>
            </form>
        </div>
        <div class="col-md-4">
            <div class="sub-info card info">
                <div class="card-body">
                    <p class="card-text">
                        This page is used to add all sessions in a schedule to a room grouping.
                    </p>
                    <p class="card-text">
                        A <strong>room group</strong> is defined as all the sessions that have the exact same date, start time, end time, room number, and have been selected to be included in a room grouping.
                    </p>
                    <p class="card-text">
                        Adding sessions to a room group will allow students from different sessions all to sign into their respective sessions using one login page.
                        This is useful when you want to have multiple sessions in one room, but only want to use one laptop to sign people in.
                    </p>
                    <p class="card-text">
                        To <strong>add</strong> all sessions in a schedule to a room grouping, simply check the "Add to Room Group"
                        checkbox and hit the <span class="button-labels">Save</span> button. This will automatically create a room group for all the sessions with the matching data listed above.
                    </p>
                    <p class="card-text">
                        To <strong>delete</strong> all sessions in a schedule to a room grouping, simply uncheck the "Add to Room Group"
                        checkbox and hit the <span class="button-labels">Save</span> button.
                    </p>
                    <p>
                        <strong>WARNING:</strong> The schedules in this page will remain check as long as every single session in the schedule is part of a room grouping.
                        If one session is removed from a room group it the session the box will then be unchecked.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready( function () {
            $.extend($.fn.dataTableExt.oStdClasses, {
                // give some foundation classes to our controls
                sLength: 'large-4 columns ',
                sFilter: 'large-12 columns ',
            });

            var table = $('#table').DataTable( {
                "aaSorting": [[0, 'asc'], [1, 'asc']],

                "aoColumns": [
                    { "orderSequence": [ null ] },
                    { "orderSequence": [ "asc", "desc" ] },
                    { "orderSequence": [ "asc", "desc" ] },
                    { "orderSequence": [ "asc", "desc" ] },
                    { "orderSequence": [ "asc", "desc" ] },
                    { "orderSequence": [ null ] },
                    { "orderSequence": [ null ] },
                    { "orderSequence": [ null ] }
                ],

                "columnDefs": [
                    {"visible": false, "targets": 0}
                ],

                "bPaginate": false,
                "bLengthChange": false,
            });
        });
    </script>

{% endblock %}
